<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>DH constant generator</title>
</head>
<body>

<h1>Diffie-Hellman constants generation<br />Генерация констант для Диффи-Хеллмана</h1>

<p>A&nbsp;=&nbsp;2<sup>a</sup>&nbsp;mod&nbsp;P; B&nbsp;=&nbsp;2<sup>b</sup>&nbsp;mod&nbsp;P; s&nbsp;=&nbsp;A<sup>b</sup>&nbsp;mod&nbsp;P&nbsp;=&nbsp;B<sup>a</sup>&nbsp;mod&nbsp;P</p>


<form>
 <p>Choose one of standard values of modulus P <a href="https://www.ietf.org/rfc/rfc3526.txt">recomended by IETF</a> or select <i>Other P</i> to use an arbitrary value.<br />Выберете одно из станадартных значений модуля P, <a href="https://www.ietf.org/rfc/rfc3526.txt">рекомендованных Инженерным советом Интернета</a>. Выберете <i>Other P</i>, чтобы ввести другое значение модуля.</p>

 <select onChange="getP(this)">
  <option value="P1536">1536 bit</option>
  <option value="P2048">2048 bit</option>
  <option value="P3072">3072 bit</option>
  <option value="P4096">4096 bit</option>
  <option value="P6144">6144 bit</option>
  <option value="P8192">8192 bit</option>
  <option value="other">Other P</option>  
 </select>
 <p>Modulus P: / Модуль P:</p>
 <textarea style="width: 90%; " rows="8" placeholder="Please enter a big prime number in hexdecimal / Введите большое простое число в шестнадцатиричной системе" id="P_textarea" oninput="bitcount()"></textarea>
 <p>Size of P: <span id="Pbits"> -</span> bits // Разрядность модуля P, бит</p>

 <p>Size of exponents (a, b): <input type="number" value="128" min="1" id="esize" /> bits // Разрядность показателей a, b</p>
 <input type="button" value="Calculate // Вычислить" onclick="calculate()" />
 <a href="#" id="downlink" download="consts.js" >Save results to file // Сохранить результаты в файл</a>
 <textarea style="width: 100%; " rows="10" id="outarea"></textarea>


</form>

<script type="text/javascript" src="DH.js"></script>

<script type="text/javascript">

 const StandMod = {
  P1536: 'FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 \
      29024E08 8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD \
      EF9519B3 CD3A431B 302B0A6D F25F1437 4FE1356D 6D51C245 \
      E485B576 625E7EC6 F44C42E9 A637ED6B 0BFF5CB6 F406B7ED \
      EE386BFB 5A899FA5 AE9F2411 7C4B1FE6 49286651 ECE45B3D \
      C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8 FD24CF5F \
      83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D \
      670C354E 4ABC9804 F1746C08 CA237327 FFFFFFFF FFFFFFFF',
  P2048: 'FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 \
      29024E08 8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD \
      EF9519B3 CD3A431B 302B0A6D F25F1437 4FE1356D 6D51C245 \
      E485B576 625E7EC6 F44C42E9 A637ED6B 0BFF5CB6 F406B7ED \
      EE386BFB 5A899FA5 AE9F2411 7C4B1FE6 49286651 ECE45B3D \
      C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8 FD24CF5F \
      83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D \
      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B \
      E39E772C 180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 \
      DE2BCBF6 95581718 3995497C EA956AE5 15D22618 98FA0510 \
      15728E5A 8AACAA68 FFFFFFFF FFFFFFFF',
  P3072: 'FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 \
      29024E08 8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD \
      EF9519B3 CD3A431B 302B0A6D F25F1437 4FE1356D 6D51C245 \
      E485B576 625E7EC6 F44C42E9 A637ED6B 0BFF5CB6 F406B7ED \
      EE386BFB 5A899FA5 AE9F2411 7C4B1FE6 49286651 ECE45B3D \
      C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8 FD24CF5F \
      83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D \
      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B \
      E39E772C 180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 \
      DE2BCBF6 95581718 3995497C EA956AE5 15D22618 98FA0510 \
      15728E5A 8AAAC42D AD33170D 04507A33 A85521AB DF1CBA64 \
      ECFB8504 58DBEF0A 8AEA7157 5D060C7D B3970F85 A6E1E4C7 \
      ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226 1AD2EE6B \
      F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C \
      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 \
      43DB5BFC E0FD108E 4B82D120 A93AD2CA FFFFFFFF FFFFFFFF',
  P4096: 'FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 \
      29024E08 8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD \
      EF9519B3 CD3A431B 302B0A6D F25F1437 4FE1356D 6D51C245 \
      E485B576 625E7EC6 F44C42E9 A637ED6B 0BFF5CB6 F406B7ED \
      EE386BFB 5A899FA5 AE9F2411 7C4B1FE6 49286651 ECE45B3D \
      C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8 FD24CF5F \
      83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D \
      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B \
      E39E772C 180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 \
      DE2BCBF6 95581718 3995497C EA956AE5 15D22618 98FA0510 \
      15728E5A 8AAAC42D AD33170D 04507A33 A85521AB DF1CBA64 \
      ECFB8504 58DBEF0A 8AEA7157 5D060C7D B3970F85 A6E1E4C7 \
      ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226 1AD2EE6B \
      F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C \
      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 \
      43DB5BFC E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7 \
      88719A10 BDBA5B26 99C32718 6AF4E23C 1A946834 B6150BDA \
      2583E9CA 2AD44CE8 DBBBC2DB 04DE8EF9 2E8EFC14 1FBECAA6 \
      287C5947 4E6BC05D 99B2964F A090C3A2 233BA186 515BE7ED \
      1F612970 CEE2D7AF B81BDD76 2170481C D0069127 D5B05AA9 \
      93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34063199 \
      FFFFFFFF FFFFFFFF',
  P6144: 'FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08 \
   8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B \
   302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9 \
   A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6 \
   49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8 \
   FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D \
   670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C \
   180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718 \
   3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D \
   04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D \
   B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226 \
   1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C \
   BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC \
   E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7 88719A10 BDBA5B26 \
   99C32718 6AF4E23C 1A946834 B6150BDA 2583E9CA 2AD44CE8 DBBBC2DB \
   04DE8EF9 2E8EFC14 1FBECAA6 287C5947 4E6BC05D 99B2964F A090C3A2 \
   233BA186 515BE7ED 1F612970 CEE2D7AF B81BDD76 2170481C D0069127 \
   D5B05AA9 93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34028492 \
   36C3FAB4 D27C7026 C1D4DCB2 602646DE C9751E76 3DBA37BD F8FF9406 \
   AD9E530E E5DB382F 413001AE B06A53ED 9027D831 179727B0 865A8918 \
   DA3EDBEB CF9B14ED 44CE6CBA CED4BB1B DB7F1447 E6CC254B 33205151 \
   2BD7AF42 6FB8F401 378CD2BF 5983CA01 C64B92EC F032EA15 D1721D03 \
   F482D7CE 6E74FEF6 D55E702F 46980C82 B5A84031 900B1C9E 59E7C97F \
   BEC7E8F3 23A97A7E 36CC88BE 0F1D45B7 FF585AC5 4BD407B2 2B4154AA \
   CC8F6D7E BF48E1D8 14CC5ED2 0F8037E0 A79715EE F29BE328 06A1D58B \
   B7C5DA76 F550AA3D 8A1FBFF0 EB19CCB1 A313D55C DA56C9EC 2EF29632 \
   387FE8D7 6E3C0468 043E8F66 3F4860EE 12BF2D5B 0B7474D6 E694F91E \
   6DCC4024 FFFFFFFF FFFFFFFF',
  P8192: 'FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 \
      29024E08 8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD \
      EF9519B3 CD3A431B 302B0A6D F25F1437 4FE1356D 6D51C245 \
      E485B576 625E7EC6 F44C42E9 A637ED6B 0BFF5CB6 F406B7ED \
      EE386BFB 5A899FA5 AE9F2411 7C4B1FE6 49286651 ECE45B3D \
      C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8 FD24CF5F \
      83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D \
      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B \
      E39E772C 180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 \
      DE2BCBF6 95581718 3995497C EA956AE5 15D22618 98FA0510 \
      15728E5A 8AAAC42D AD33170D 04507A33 A85521AB DF1CBA64 \
      ECFB8504 58DBEF0A 8AEA7157 5D060C7D B3970F85 A6E1E4C7 \
      ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226 1AD2EE6B \
      F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C \
      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 \
      43DB5BFC E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7 \
      88719A10 BDBA5B26 99C32718 6AF4E23C 1A946834 B6150BDA \
      2583E9CA 2AD44CE8 DBBBC2DB 04DE8EF9 2E8EFC14 1FBECAA6 \
      287C5947 4E6BC05D 99B2964F A090C3A2 233BA186 515BE7ED \
      1F612970 CEE2D7AF B81BDD76 2170481C D0069127 D5B05AA9 \
      93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34028492 \
      36C3FAB4 D27C7026 C1D4DCB2 602646DE C9751E76 3DBA37BD \
      F8FF9406 AD9E530E E5DB382F 413001AE B06A53ED 9027D831 \
      179727B0 865A8918 DA3EDBEB CF9B14ED 44CE6CBA CED4BB1B \
      DB7F1447 E6CC254B 33205151 2BD7AF42 6FB8F401 378CD2BF \
      5983CA01 C64B92EC F032EA15 D1721D03 F482D7CE 6E74FEF6 \
      D55E702F 46980C82 B5A84031 900B1C9E 59E7C97F BEC7E8F3 \
      23A97A7E 36CC88BE 0F1D45B7 FF585AC5 4BD407B2 2B4154AA \
      CC8F6D7E BF48E1D8 14CC5ED2 0F8037E0 A79715EE F29BE328 \
      06A1D58B B7C5DA76 F550AA3D 8A1FBFF0 EB19CCB1 A313D55C \
      DA56C9EC 2EF29632 387FE8D7 6E3C0468 043E8F66 3F4860EE \
      12BF2D5B 0B7474D6 E694F91E 6DBE1159 74A3926F 12FEE5E4 \
      38777CB6 A932DF8C D8BEC4D0 73B931BA 3BC832B6 8D9DD300 \
      741FA7BF 8AFC47ED 2576F693 6BA42466 3AAB639C 5AE4F568 \
      3423B474 2BF1C978 238F16CB E39D652D E3FDB8BE FC848AD9 \
      22222E04 A4037C07 13EB57A8 1A23F0C7 3473FC64 6CEA306B \
      4BCBC886 2F8385DD FA9D4B7F A2C087E8 79683303 ED5BDD3A \
      062B3CF5 B3A278A6 6D2A13F8 3F44F82D DF310EE0 74AB6A36 \
      4597E899 A0255DC1 64F31CC5 0846851D F9AB4819 5DED7EA1 \
      B1D510BD 7EE74D73 FAF36BC3 1ECFA268 359046F4 EB879F92 \
      4009438B 481C6CD7 889A002E D5EE382B C9190DA6 FC026E47 \
      9558E447 5677E9AA 9E3050E2 765694DF C81F56E8 80B96E71 \
      60C980DD 98EDD3DF FFFFFFFF FFFFFFFF' 
 };

 var pta=document.getElementById('P_textarea'), Pbits=document.getElementById('Pbits'), outarea=document.getElementById('outarea'), esize=document.getElementById('esize'), downlink=document.getElementById('downlink');
 var hsP='', BSP=0, BSPM, file=null, P, LD, LDE, BSP;
 
 function bitcount() {
 	var i, s2='', c, cn, s=pta.value.toLowerCase();
 	BSP=0;
 	for (i=0; i<s.length; i++) {
 		c=s.charAt(i);
 		cn=s.charCodeAt(i);
 		// 0..9, A..F 		
 		if (cn>=48 && cn<=57 || cn>=97 && cn<=102) s2+=c, BSP+=4; 		
 	}
 	if (BSP>0) Pbits.innerHTML=BSP; else Pbits.innerHTML=' -';
 	hsP=s2; 
 }
 
 function calculate() {
  
  if (BSP==0) {
   alert('Please enter a valid hexdecimal P value // Пожалуйста, введите корректное шестнадцатиричное значение модуля P');
   return;  
  }
  
  var lowerbits=0;
  for (BSPM=1; BSPM<=BSP; BSPM*=2) lowerbits++;
  if (BSPM>BSP) BSPM/=2, lowerbits--;
  
  s='0x'+hsP.slice(0, 8)+'];';
  for (pos=8; pos<hsP.length; pos+=8)
   s='0x'+hsP.slice(pos, pos+8)+', '+s;
  s='P=['+s+'\n\n';
  
  eval(s);
  
  s='const '+s;
  
  LD=Math.ceil(hsP.length/8)-1;
  LDE=Math.ceil(esize.value/32)-1;
  
  var base_bit=BSPM/2, GC=[], base_digit=Math.floor(base_bit/32), base_digit_bit=base_bit%32, bm=1;
  for (i=0; i<base_digit; i++) GC[i]=0;
  for (i=1; i<=base_digit_bit; i++) bm*=2;
  GC[base_digit]=bm;
  for (i=base_digit+1; i<=LD; i++) GC[i]=0;
  
  var GCstr='const GP=[';  
   
  
  var GCLD=esize.value - lowerbits;  
  
  for (i=0; i<GCLD; i++) {
   SqrMod(GC);
   GCstr+='['+GC+'],\n';
  }
  
  SqrMod(GC);
  GCstr+='['+GC+']];\n';

  s+='const BSP='+BSP+', BSPM='+BSPM+', LD='+LD+', LDE='+LDE+';\n\n'+GCstr;  
  
  outarea.value=s;
  file=new Blob([s], {type: 'text/plain'});
  downlink.href=URL.createObjectURL(file); 	
  downlink.download='consts'+BSP+'_'+esize.value+'bit.js';


  
 }
 
 function getP(t) {
 	if (t.value=='other') pta.value=''; else pta.value=StandMod[t.value];
 	bitcount();
 }
 
 pta.value=StandMod.P1536; 
 bitcount();
 
</script>



</body>
</html>